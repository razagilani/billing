<html>
<head>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title id="pagetitle">TITLE</title>

    <head profile="http://www.w3.org/2005/10/profile">
    <link rel="icon" type="image/x-icon" href="favicon.ico">

    <!-- page specific -->
    <link rel="stylesheet" type="text/css" href="billedit.css" />

    <script type="text/javascript" src="DateFormat-minified.js"></script>

    <style type=text/css>
        /* style rows on mouseover */
        .x-grid3-row-over .x-grid3-cell-inner {
            font-weight: bold;
        }
        .icon-application-go {
            background-image: url(ext-3.3.1/examples/shared/icons/fam/application_go.png) !important;
        }
        .icon-mail-go {
            background-image: url(ext-3.3.1/examples/layout-browser/images/email_go.png) !important;
        }
        .icon-add {
            background-image: url(ext-3.3.1/examples/shared/icons/fam/add.png) !important;
        }
        .icon-delete {
            background-image: url(ext-3.3.1/examples/shared/icons/fam/delete.gif) !important;
        }
        .icon-save {
            background-image: url(ext-3.3.1/examples/shared/icons/fam/accept.png) !important;
        }
    </style>

    <!-- ** CSS ** -->
    <!-- base library -->
    <link rel="stylesheet" type="text/css" href="ext-3.3.1/resources/css/ext-all.css" />
    <link rel="stylesheet" type="text/css" href="ext-3.3.1/examples/ux/css/Spinner.css" /> 

    <!-- ** Javascript ** -->
    <!-- ExtJS library: base/adapter -->
    <!--script type="text/javascript" src="ext-3.3.1/adapter/ext/ext-base.js"></script-->
    <script type="text/javascript" src="ext-3.3.1/adapter/ext/ext-base-debug.js"></script>

    <!-- ExtJS library: all widgets -->
    <!--script type="text/javascript" src="ext-3.3.1/ext-all-debug.js"></script-->
    <script type="text/javascript" src="ext-3.3.1/ext-all.js"></script>

    <!-- extensions -->

    <!-- ToDo: move out of examples -->
    <script type="text/javascript" src="ext-3.3.1/examples/ux/Spinner.js"></script>
    <script type="text/javascript" src="ext-3.3.1/examples/ux/SpinnerField.js"></script>

    <script type="text/javascript" src="ext-3.3.1/examples/ux/GroupSummary.js"></script>

    <link rel="stylesheet" type="text/css" href="fileuploadfield.css"/> 
    <script type="text/javascript" src="FileUploadField.js"></script>

    <!-- ext status bar -->
    <script type="text/javascript" src="statusbar/StatusBar.js"></script>

    <!-- Animal's linkbutton -->
    <script type="text/javascript" src="linkbutton.js"></script>
    <link rel="stylesheet" type="text/css" href="linkbutton.css" />

    <!-- overrides to base library -->

    <!-- page specific -->
    <script type="text/javascript" src="login.js"></script>
    <script type="text/javascript" src="billedit.js"></script>

    <!-- start the execution of javascript code -->
    <script type="text/javascript">


        /* Global variables for UI configuration */
        var mailPanelDisabled;
        var preferencesPanelDisabled;
        var reportPanelDisabled;
        var journalPanelDisabled;
        var aboutPanelDisabled;
        var chargeItemsPanelDisabled;
        var rateStructurePanelDisabled;
        var billPeriodsPanelDisabled;
        var usagePeriodsPanelDisabled;
        var reeBillPanelDisabled;
        var utilityBillPanelDisabled;
        var accountsPanelDisabled;
        var paymentPanelDisabled;

        Ext.onReady(function() {

          // so that forms show quick tips
          Ext.QuickTips.init();

          // TODO check auth session status first, and the go after configuration

          /* load ui configuration from server (which tabs to show/hide) */
          Ext.Ajax.request({
            url: 'http://' + location.host + '/reebill/ui_configuration',
            success: function(response) {
                // preload graphics
                var img1 = new Image();
                img1.src = "http://reebill-dev/green_stripe.jpg";
                var img2 = new Image();
                img2.src = "http://reebill-dev/skyline_logo.png";
                var img3 = new Image();
                img3.src = "http://reebill-dev/money_chaser.png";
                var img4 = new Image();
                img4.src = "http://reebill-dev/reebill_logo.png";
                var jsonData = Ext.util.JSON.decode(response.responseText);
                mailPanelDisabled = jsonData.mail_panel_disabled;
                preferencesPanelDisabled = jsonData.preferences_panel_disabled;
                reportPanelDisabled = jsonData.report_panel_disabled;
                journalPanelDisabled = jsonData.preferences_panel_disabled;
                aboutPanelDisabled = jsonData.about_panel_disabled;
                chargeItemsPanelDisabled = jsonData.charge_items_panel_disabled;
                rateStructurePanelDisabled = jsonData.rate_structure_panel_disabled;
                billPeriodsPanelDisabled = jsonData.bill_periods_panel_disabled;
                usagePeriodsPanelDisabled = jsonData.usage_periods_panel_disabled;
                reeBillPanelDisabled = jsonData.reebill_panel_disabled;
                utilityBillPanelDisabled = jsonData.utility_bill_panel_disabled;
                accountsPanelDisabled = jsonData.accounts_panel_disabled;
                paymentPanelDisabled = jsonData.payment_panel_disabled;
                issuablePanelDisabled = jsonData.issuable_panel_disabled;

                defaultAccountSortField = jsonData.default_account_sort_field;
                defaultAccountSortDir = jsonData.default_account_sort_dir;

                reeBillReady();

                Ext.get('loading').fadeOut();
                Ext.get('header').fadeIn();
                Ext.get('footer').fadeIn();

                loadDashboard();
            },
            failure: function() {
              Ext.Msg.alert('Error', 'Failed to load UI configuration from the server');
            },
          });
        });

    </script>
</head>
<body>
  <div id="loading" style="width:650px; margin-left:-250px; position:absolute; top:30%; left: 50%; background-color: white; -moz-box-shadow: 0 0 30px 5px #999; -webkit-box-shadow: 0 0 30px 5px #999;">
    <table style="width:100%">
      <tr><td style="text-align: right;"><img style="height:350px;" src="rotologo_white.gif"/></td><td style="text-align: left"><img src="skylineinnovations_text.jpg"/></td></tr>
      <tr><td colspan="2" style="text-align: center;">Initializing...</td></tr>
    </table>
  </div>
</body>
</html>
