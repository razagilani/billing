<!-- 
 Contains main view for create-extractor UI. 
 Displays a PDF viewer, and a list of UI elements to create a new layout extractor.
 -->

<div pdf-panel bill-id="{{ bill_id }}">
	<!-- PDF renderer goes here. -->

	<div id="bbox-drawing-layer"><canvas bbox-drawing></canvas></div>
</div>
<div id="separator">&nbsp;</div>
<div id="extractor-controls">
	<!-- Extractor-level parameters/settings -->
	<div id="extractor-settings">
		<h3>Extractor: <input style="width:60%" class="left-margin textbox-flush" type="text" ng-model="extractor.name"></h3>

		<b> Representative Bill ID </b>
		<input class="left-margin" type="text" ng-model="extractor.representative_bill_id">
		<br><br>

		<b> Offset Regex </b>
		<input class="left-margin" type="text" ng-model="extractor.offset_regex">
		<br><br>

		<b> Offset Coordinates </b>
		<pre class="left-margin bbox-coords">x: 34 y: 50</pre>
	</div>
	<hr class="divider">

	<!-- List of fields for current extractor -->
	<div id="fields-list">
		<h3>Fields</h3>
		<table id="fields">
			<colgroup>
				<col style="width:150px">
				<col style="width:150px">
				<col style="width:150px">
			</colgroup>
			<thead>
				<tr>
					<td>Applier Key</td>
					<td>Field Type </td>
					<td>Data Type </td>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="field in extractor.fields" 
					ng-class="{'disabled': !field.enabled, 'selected': selected.applier_key == field.applier_key}">

					<td ng-click="selectField(field)"> {{ field.applier_key | capitalize }} </td>
					<td> 
						<select ng-model="field.field_type" 
								ng-values="ftype.mapper_id for ftype in field_types" 
								ng-options="ftype.name | capitalize for ftype in field_types"
								ng-disabled="!field.enabled">
						</select>
					</td>
					<td>
						<select ng-model="field.data_type" 
								ng-values="dt for dt in data_types" 
								ng-options="dt | capitalize for dt in data_types"
								ng-disabled="!field.enabled">
						</select>
					</td>
					<td>
						<div class="addbutton" ng-click="enableField(field)"> {{ field.enabled ? "â€“" : "+" }} </div>
					</td>
				</tr>
			</tbody>
		</table>
	</div> 
	<hr class="divider">

	<!-- Settings for individual fields -->
	<div class="field-settings" ng-show="selected">
		<h3> {{ selected.applier_key | capitalize }} </h3>

		<b> Page Number </b>
		<select class="left-margin" 
				ng-model="selected.page_number" 
				ng-options="pn for pn in getPDFPageNums(false)" 
				ng-values="pn for pn in getPDFPageNums(false)">
		</select>
		<span class="left-margin">to</span> 
		<select class="left-margin" 
				ng-model="selected.max_page" 
				ng-options="pn | denullify for pn in getPDFPageNums(true)" 
				ng-values="pn for pn in getPDFPageNums(true)">
		</select>
		<br><br>

		<b> Offset Regex </b>
		<input class="left-margin" type="text" ng-model="selected.offset_regex"></input>
		<br><br>

		<b> Bounding Box </b>
		<pre class="left-margin bbox-coords" 
			 ng-click="activateBoundingBox()"
			 ng-model="bboxActive"
			 ng-class="{ 'active': bboxActive }"> {{ selected.bounding_box | bboxToString }} </pre>
		<span style="margin-left:10px; font-weight:bold">X</span>
		<br><br>

		<b> Corner <b>
		<select class="left-margin"
				ng-model="selected.corner"
				ng-options="c.name for c in corners"
				ng-values="c.value for c in corners">
		</select>
		<br><br>

		<b> Regular Expression </b>
		<input class="left-margin" type="text" ng-model="selected.regex"></input>
		<hr class="divider">
	</div>
	
</div>